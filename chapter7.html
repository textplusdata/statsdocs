<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Chapter 7</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Stats Documents</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Contents
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Stats Data and Models</li>
    <li>
      <a href="chapter1.html">Chapter 1</a>
    </li>
    <li>
      <a href="chapter2.html">Chapter 2</a>
    </li>
    <li>
      <a href="chapter3.html">Chapter 3</a>
    </li>
    <li>
      <a href="chapter4.html">Chapter 4</a>
    </li>
    <li>
      <a href="chapter5.html">Chapter 5</a>
    </li>
    <li>
      <a href="chapter6.html">Chapter 6</a>
    </li>
    <li>
      <a href="chapter7.html">Chapter 7</a>
    </li>
    <li>
      <a href="chapter8.html">Chapter 8</a>
    </li>
    <li>
      <a href="chapter10.html">Chapter 10, 11, 12, 13, 14</a>
    </li>
    <li>
      <a href="chapter15.html">Chapter 15</a>
    </li>
    <li>
      <a href="chapterX.html">Chapter XXX</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Notes about using R</li>
    <li>
      <a href="using-rmarkdown.html">Using R Markdown</a>
    </li>
    <li>
      <a href="other-notes.html">Other notes</a>
    </li>
    <li>
      <a href="packages.html">Packages</a>
    </li>
    <li>
      <a href="maths-symbols.html">Maths symbols</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Chapter 7</h1>

</div>


<div id="linear-regression" class="section level1">
<h1>Linear Regression</h1>
<p>Linear regression helps us to predict what one variable will be if we have data for another variable. Correlation on its own is not enough.</p>
<div id="least-squares---the-line-of-best-fit" class="section level2">
<h2>Least squares - the line of best fit</h2>
<p>It is possible to draw a line of best fit through data to help make predictions.Of course, the line won’t join up with all of the data points, but it will show the trend. We want the line that is closest to all the data points compared to any other possible line.</p>
<p>The predicted value from the model is called y-hat or: $  $</p>
<p>Now we have the data, lets run the summary:</p>
<pre class="r"><code>summary(burgers)</code></pre>
<pre><code>##                                       Item      Serving_size  
##  1%LowFatChocolateMilk(8oz)             :  1   Min.   : 43.0  
##  A1¨_Steakhouse_XTª                     :  1   1st Qu.:113.5  
##  AmericanOriginalChicken_Sandwich       :  1   Median :158.0  
##  Bacon_Cheeseburger                     :  1   Mean   :167.8  
##  BaconEgg&amp;CheeseBiscuit                 :  1   3rd Qu.:216.5  
##  Biscuit_w/ChickenFri[er(ChickenBiscuit):  1   Max.   :487.0  
##  (Other)                                :116   NA&#39;s   :11     
##     Calories       Fat_Cal          Fat_g          SatFat_g     
##  Min.   :  25   Min.   :  0.0   Min.   : 0.00   Min.   : 0.000  
##  1st Qu.: 310   1st Qu.:127.5   1st Qu.:14.25   1st Qu.: 4.000  
##  Median : 410   Median :190.0   Median :22.00   Median : 7.000  
##  Mean   : 454   Mean   :206.2   Mean   :24.83   Mean   : 8.701  
##  3rd Qu.: 550   3rd Qu.:267.0   3rd Qu.:33.00   3rd Qu.:12.000  
##  Max.   :1310   Max.   :650.0   Max.   :82.00   Max.   :32.000  
##                 NA&#39;s   :6                                       
##    TransFat_g        Chol_mg         Sodium_mg          Carb_g      
##  Min.   :0.0000   Min.   :  0.00   Min.   :   0.0   Min.   :  2.00  
##  1st Qu.:0.0000   1st Qu.: 20.00   1st Qu.: 490.0   1st Qu.: 27.00  
##  Median :0.0000   Median : 52.50   Median : 905.0   Median : 34.50  
##  Mean   :0.3033   Mean   : 92.83   Mean   : 930.2   Mean   : 39.65  
##  3rd Qu.:0.5000   3rd Qu.:143.75   3rd Qu.:1245.0   3rd Qu.: 50.00  
##  Max.   :2.0000   Max.   :455.00   Max.   :3310.0   Max.   :134.00  
##                                                                     
##     Fiber_g         Sugar_g         Protein_g    
##  Min.   :0.000   Min.   : 0.000   Min.   : 0.00  
##  1st Qu.:1.000   1st Qu.: 3.000   1st Qu.: 7.00  
##  Median :1.000   Median : 6.000   Median :15.50  
##  Mean   :1.897   Mean   : 9.967   Mean   :18.02  
##  3rd Qu.:3.000   3rd Qu.: 9.750   3rd Qu.:24.75  
##  Max.   :9.000   Max.   :58.000   Max.   :71.00  
##  NA&#39;s   :6</code></pre>
<p>Now to replicate the scatter plot in the textbook:</p>
<pre class="r"><code># This was useful: https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html

library(ggplot2)
library(ggrepel)
ggplot(burgers) +
 aes(x = Protein_g, y = Fat_g) +
 geom_point(size = 3L,color = ifelse(burgers$Protein_g &gt;30.5 &amp; burgers$Protein_g &lt;31.8, &quot;red&quot;, &quot;black&quot;)) +

 #geom_smooth(span = 0.75) +
  geom_smooth(method=&#39;lm&#39;,color=&quot;red&quot;) +
 labs(x = &quot;Protein (grams)&quot;, y = &quot;Fat (grams)&quot;, title = &quot;Burger King meal items&quot;) +
  
  # use modified geom_text code to filter labels to only specifics
   geom_text_repel(data=subset(burgers, Protein_g &gt;30.5 &amp; Protein_g &lt;31.8 ),
            aes(Protein_g,Fat_g,label=Item)) +
 theme_minimal()</code></pre>
<p><img src="chapter7_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We would expect the items with around 31 grams of protein to have about 37 grams of fat, but one of these items only has 22 grams of fat. It is a chicken sandwich, and chicken normally has a lower fat content. The other item, the Double-Bacon cheesburger, is much closer to the predictde value.</p>
<p>The <em>residual</em> tells us how far off from the predicted value the observed value is.</p>
<p>Residual = Observed value - Predicted value.</p>
<p>In this case the residual is about 15 grams of fat.</p>
<p>So the best-fit line will be the one with the least residuals.</p>
<p><em>BUT</em> if we just add up all the residuals, some will be negative and some will be positive, so they will cancel each other out. So instead we square the values, just like we do in standard deviation, so we only have positive numbers.</p>
<p>So the line can be evaluated by squaring all the residuals and then choosing the line with the smallest sum. Also known as <em>“the least squares line”</em> (this is a bit weird, because least squares sounds like the least number of squares but it’s actually the smallest square sum…)</p>
</div>
<div id="linear-model" class="section level2">
<h2>Linear model</h2>
<p>In algebra, a straight line can be written as: y = mx + b</p>
<p>The linear model can be written in similar way in statistics:</p>
<p>$  = b_0 + b_1x$</p>
<p>y-hat signifies that these are predicted values. $ b_1$ is the slope while $ b_0$ is the <em>intercept</em> - the value where the line cuts the y-axis.</p>
<p>So in the Burger King example above, the line of best fit is:</p>
<p>$  = $ 8.4 + 0.91g Protein</p>
<p>The line starts at 8.4g (though this is misleading of course and it doesn’t necessarily mean that an item exists with 0g Protein will have 8.g of fat, so this part of the line should be considered carefully) and then for every additional gram of protein, the item contains an additional 0.91grams of Fat.</p>
</div>
<div id="finding-the-least-squares-line" class="section level2">
<h2>Finding the least squares line</h2>
<p>The formula is built up of:</p>
<p>The means - tells us where to put the line The standard deviations - to get the units The correlation - to tell us the strength of the relationship.</p>
<p>So slope (b1) is:</p>
<p>$ b_1 = r $</p>
<p>Correlations don’t have units, but slopes do, for example you express time in days, months or years and you would get a different slope depending on which one you used (growth of kids expressed over years will look much sharper than expressed over days…, it will also result in a different standard deviation number, which will be much larger when measuring in days compared to years).</p>
<p>The units of the slope are always <em>how many units of y per unit of x</em>.</p>
<p>The intercept: The value of y when the x value was $  $ should obviously be $  $. So:</p>
<p><span class="math inline">\(b_0 = \overline{y} - b_1 \overline{x}\)</span></p>
<p>Intercept = y-mean minus slope * x-mean</p>
<div id="example---finding-regression-equation" class="section level3">
<h3>Example - finding regression equation</h3>
<p>Need to get the Mean of the variables and the standard deviation.</p>
<pre class="r"><code>fatMean &lt;- mean(burgers$Fat_g)

fatMean</code></pre>
<pre><code>## [1] 24.82787</code></pre>
<pre class="r"><code>protMean &lt;- mean(burgers$Protein_g)

protMean</code></pre>
<pre><code>## [1] 18.01639</code></pre>
<pre class="r"><code>fatSD &lt;- sd(burgers$Fat_g)
fatSD</code></pre>
<pre><code>## [1] 16.19557</code></pre>
<pre class="r"><code>protSD &lt;- sd(burgers$Protein_g)
protSD</code></pre>
<pre><code>## [1] 13.48766</code></pre>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
